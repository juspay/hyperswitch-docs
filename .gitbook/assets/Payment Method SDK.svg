<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="850.3373798212383" height="425.921577736"><desc>sequenceDiagram%0A%20%20%20%20autonumber%0A%20%20%20%20participant%20%22Customer%22%20as%20C%0A%20%20%20%20participant%20%22Merchant%20Server%22%20as%20M%0A%20%20%20%20participant%20%22Hyperswitch%20Server%22%20as%20H%0A%20%20%20%20participant%20%22Hyperswitch%20Vault%22%20as%20V%0A%20%20%20%20participant%20%22PSP%20%2F%20Network%20(Optional)%22%20as%20P%0A%0A%20%20%20%20Note%20over%20M%3A%20Prerequisites%3A%20PCI%20DSS%20Compliance%20%26%20API%20Key%0A%20%20%20%20%0A%20%20%20%20C-%3E%3EM%3A%20Enters%20Card%20Details%20%0A%20%20%20%20%0A%20%20%20%20rect%20rgb(240%2C%20245%2C%20255)%0A%20%20%20%20Note%20right%20of%20M%3A%20Step%201%3A%20Create%20Customer%0A%20%20%20%20M-%3E%3EH%3A%20POST%20%2Fv2%2Fcustomers%0A%20%20%20%20H--%3E%3EM%3A%20Return%20customer_id%0A%20%20%20%20end%0A%0A%20%20%20%20rect%20rgb(235%2C%20255%2C%20235)%0A%20%20%20%20Note%20right%20of%20M%3A%20Step%202%3A%20Create%20Payment%20Method%20Token%0A%20%20%20%20M-%3E%3EH%3A%20POST%20%2Fv2%2Fpayment-methods%20(Card%20Data%20%2B%20customer_id)%0A%20%20%20%20%0A%20%20%20%20H-%3E%3EV%3A%20Store%20Raw%20Card%20Data%0A%20%20%20%20V--%3E%3EH%3A%20Generate%20Secure%20pm_id%0A%20%20%20%20%0A%20%20%20%20opt%20If%20psp_tokenization%20or%20network_tokenization%20enabled%0A%20%20%20%20%20%20%20%20H-%3E%3EP%3A%20Request%20PSP%2FNetwork%20Token%0A%20%20%20%20%20%20%20%20P--%3E%3EH%3A%20Return%20External%20Token%0A%20%20%20%20%20%20%20%20H-%3E%3EV%3A%20Map%20External%20Token%20to%20pm_id%0A%20%20%20%20end%0A%0A%20%20%20%20H--%3E%3EM%3A%20Return%20pm_id%20%26%20Token%20Details%0A%20%20%20%20end%0A%0A%20%20%20%20M--%3E%3EC%3A%20Confirm%20Card%20Saved%20%2F%20Process%20Payment</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="850" height="425"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 36.15338186690625 33.876698536 L 36.15338186690625 425.921577736" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="7.732640615384615,3.3508109333333334"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 240.83081049568227 33.876698536 L 240.83081049568227 425.921577736" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="7.732640615384615,3.3508109333333334"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 505.907088611763 33.876698536 L 505.907088611763 425.921577736" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="7.732640615384615,3.3508109333333334"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 661.3287646770625 33.876698536 L 661.3287646770625 425.921577736" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="7.732640615384615,3.3508109333333334"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 782.2944410695665 33.876698536 L 782.2944410695665 425.921577736" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="7.732640615384615,3.3508109333333334"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 5.026216400000003 6.835654304000002 L 67.2805473338125 6.835654304000002 L 67.2805473338125 33.876698536 L 5.026216400000003 33.876698536 L 5.026216400000003 6.835654304000002 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="15.933105988000001" y="23.824265736" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Customer</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 195.44218567819007 6.835654304000002 L 286.2194353131745 6.835654304000002 L 286.2194353131745 33.876698536 L 195.44218567819007 33.876698536 L 195.44218567819007 6.835654304000002 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="206.34907526619008" y="23.824265736" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Merchant Server</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 454.55966252473957 6.835654304000002 L 557.2545146987865 6.835654304000002 L 557.2545146987865 33.876698536 L 454.55966252473957 33.876698536 L 454.55966252473957 6.835654304000002 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="465.4665521127396" y="23.824265736" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Hyperswitch Server</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 613.4322434362305 6.835654304000002 L 709.2252859178946 6.835654304000002 L 709.2252859178946 33.876698536 L 613.4322434362305 33.876698536 L 613.4322434362305 6.835654304000002 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="624.3391330242305" y="23.824265736" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Hyperswitch Vault</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 719.2777187178946 6.835654304000002 L 845.3111634212383 6.835654304000002 L 845.3111634212383 33.876698536 L 719.2777187178946 33.876698536 L 719.2777187178946 6.835654304000002 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="730.1846083058946" y="23.824265736" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">PSP / Network (Optional)</text></g></g><g><g><rect fill="white" stroke="none" x="99.13359191803255" y="53.981564136" width="86.49806016226563" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="100.64145683803255" y="63.028753656" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Enters Card Details </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="92.86040520229037" y="63.028753656" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 36.15338186690625 67.049726776 L 239.57425639568228 67.049726776" stroke-miterlimit="10" stroke-width="0.8377027333333333"/><g transform="translate(240.83081049568227,67.049726776) translate(-240.83081049568227,-67.049726776)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 232.21835241380288 63.20763601561635 L 239.88908750149798 67.049726776 L 232.21835241380288 70.89181753638366" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><rect fill="white" stroke="none" x="332.71889560784376" y="82.128375976" width="89.0811595275" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="334.22676052784374" y="91.175565496" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST /v2/customers</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="326.44570889210155" y="91.175565496" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 240.83081049568227 95.196538616 L 504.650534511763 95.196538616" stroke-miterlimit="10" stroke-width="0.8377027333333333"/><g transform="translate(505.907088611763,95.196538616) translate(-505.907088611763,-95.196538616)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 497.2946305298836 91.35444785561634 L 504.9653656175787 95.196538616 L 497.2946305298836 99.03862937638365" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><rect fill="white" stroke="none" x="335.04457157219923" y="110.275187816" width="84.42980759878907" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="336.5524364921992" y="119.322377336" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return customer_id</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="328.771384856457" y="119.322377336" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 505.907088611763 123.343350456 L 242.08736459568226 123.343350456" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="4.02097312"/><g transform="translate(240.83081049568227,123.343350456) translate(-240.83081049568227,-123.343350456)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 249.44326857756167 119.50125969561634 L 241.77253348986656 123.343350456 L 249.44326857756167 127.18544121638365" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><rect fill="white" stroke="none" x="260.5072409447578" y="138.421999656" width="233.50446885367188" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="262.0151058647578" y="147.469189176" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST /v2/payment-methods (Card Data + customer_id)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="254.2340542290156" y="147.469189176" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 240.83081049568227 151.490162296 L 504.650534511763 151.490162296" stroke-miterlimit="10" stroke-width="0.8377027333333333"/><g transform="translate(505.907088611763,151.490162296) translate(-505.907088611763,-151.490162296)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 497.2946305298836 147.64807153561634 L 504.9653656175787 151.490162296 L 497.2946305298836 155.33225305638365" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><rect fill="white" stroke="none" x="541.6649628474597" y="166.568811496" width="91.68697922964844" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="543.1728277674597" y="175.61600101599998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Store Raw Card Data</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="535.3917761317175" y="175.61600101599998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 505.907088611763 179.636974136 L 660.0722105770625 179.636974136" stroke-miterlimit="10" stroke-width="0.8377027333333333"/><g transform="translate(661.3287646770625,179.636974136) translate(-661.3287646770625,-179.636974136)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 652.7163065951831 175.79488337561634 L 660.3870416828782 179.636974136 L 652.7163065951831 183.47906489638365" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><rect fill="white" stroke="none" x="536.4715271785144" y="194.715623336" width="102.07385056753907" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="537.9793920985144" y="203.76281285599998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate Secure pm_id</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="530.1983404627722" y="203.76281285599998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 661.3287646770625 207.783785976 L 507.16364271176303 207.783785976" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="4.02097312"/><g transform="translate(505.907088611763,207.783785976) translate(-505.907088611763,-207.783785976)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 514.5195466936424 203.94169521561633 L 506.84881160594733 207.783785976 L 514.5195466936424 211.62587673638365" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><rect fill="white" stroke="none" x="586.3282896301374" y="250.004003736" width="123.32600205679688" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="587.8361545501374" y="259.051193256" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Request PSP/Network Token</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="580.0551029143952" y="259.051193256" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 505.907088611763 263.072166376 L 781.0378869695664 263.072166376" stroke-miterlimit="10" stroke-width="0.8377027333333333"/><g transform="translate(782.2944410695665,263.072166376) translate(-782.2944410695665,-263.072166376)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 773.6819829876871 259.23007561561633 L 781.3527180753822 263.072166376 L 773.6819829876871 266.91425713638364" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><rect fill="white" stroke="none" x="600.3278318664655" y="278.15081557599996" width="95.32691758414063" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="601.8356967864655" y="287.198005096" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return External Token</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="594.0546451507233" y="287.198005096" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 782.2944410695665 291.218978216 L 507.16364271176303 291.218978216" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="4.02097312"/><g transform="translate(505.907088611763,291.218978216) translate(-505.907088611763,-291.218978216)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 514.5195466936424 287.3768874556163 L 506.84881160594733 291.218978216 L 514.5195466936424 295.06106897638364" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><rect fill="white" stroke="none" x="525.5835190608386" y="306.29762741599995" width="123.84986680289063" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="527.0913839808386" y="315.344816936" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Map External Token to pm_id</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="519.3103323450964" y="315.344816936" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 505.907088611763 319.365790056 L 660.0722105770625 319.365790056" stroke-miterlimit="10" stroke-width="0.8377027333333333"/><g transform="translate(661.3287646770625,319.365790056) translate(-661.3287646770625,-319.365790056)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 652.7163065951831 315.5236992956163 L 660.3870416828782 319.365790056 L 652.7163065951831 323.20788081638364" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><rect fill="white" stroke="none" x="316.63517826165236" y="349.523088456" width="126.4374827696875" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="318.14304318165233" y="358.570277976" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return pm_id &amp; Token Details</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="305.17310299610546" y="358.570277976" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">10 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 505.907088611763 362.591251096 L 242.08736459568226 362.591251096" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="4.02097312"/><g transform="translate(240.83081049568227,362.591251096) translate(-240.83081049568227,-362.591251096)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 249.44326857756167 358.74916033561635 L 241.77253348986656 362.591251096 L 249.44326857756167 366.43334185638366" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><rect fill="white" stroke="none" x="60.50846221832552" y="377.669900296" width="168.42696946402344" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="62.01632713832552" y="386.717089816" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Confirm Card Saved / Process Payment</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="49.556625600239585" y="386.717089816" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">11 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 240.83081049568227 390.738062936 L 37.409935966906254 390.738062936" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="4.02097312"/><g transform="translate(36.15338186690625,390.738062936) translate(-36.15338186690625,-390.738062936)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 44.76583994878566 386.89597217561635 L 37.09510486109055 390.738062936 L 44.76583994878566 394.58015369638366" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 470.723573811763 222.862435176 L 817.4779558695665 222.862435176 L 817.4779558695665 334.444439256 L 470.723573811763 334.444439256 L 470.723573811763 222.862435176 Z" stroke-miterlimit="10" stroke-width="1.4360618285714286" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 470.723573811763 222.862435176 L 470.723573811763 234.925354536 L 502.4263855787552 234.925354536 L 508.4578452587552 228.893894856 L 508.4578452587552 222.862435176 L 470.723573811763 222.862435176" stroke-miterlimit="10" stroke-width="1.4360618285714286"/><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="480.776006611763" y="230.90438141599998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">opt</text><g><rect fill="white" stroke="none" x="517.0024131387552" y="223.66662979999998" width="193.67884629507813" height="10.454530112"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="518.5102780587551" y="230.90438141599998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[If psp_tokenization or network_tokenization enabled]</text></g></g></g></svg>