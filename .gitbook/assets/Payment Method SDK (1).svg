<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="763.7298206171367" height="397.774765896"><desc>sequenceDiagram%0A%20%20%20%20autonumber%0A%20%20%20%20participant%20%22Customer%22%20as%20C%0A%20%20%20%20participant%20%22Merchant%20Server%22%20as%20M%0A%20%20%20%20participant%20%22Hyperswitch%20Server%22%20as%20H%0A%20%20%20%20participant%20%22Hyperswitch%20Vault%22%20as%20V%0A%20%20%20%20participant%20%22PSP%20%2F%20Network%20(Optional)%22%20as%20P%0A%0A%20%20%20%20Note%20over%20M%3A%20Prerequisites%3A%20PCI%20DSS%20Compliance%20%26%20API%20Key%0A%20%20%20%20%0A%20%20%20%20C-%3E%3EM%3A%20Enters%20Card%20Details%20%0A%20%20%20%20%0A%20%20%20%20rect%20rgb(240%2C%20245%2C%20255)%0A%20%20%20%20Note%20right%20of%20M%3A%20Step%201%3A%20Create%20Customer%0A%20%20%20%20M-%3E%3EH%3A%20POST%20%2Fv2%2Fcustomers%0A%20%20%20%20H--%3E%3EM%3A%20Return%20customer_id%0A%20%20%20%20end%0A%0A%20%20%20%20rect%20rgb(235%2C%20255%2C%20235)%0A%20%20%20%20Note%20right%20of%20M%3A%20Step%202%3A%20Create%20Payment%20Method%20Token%0A%20%20%20%20M-%3E%3EH%3A%20POST%20%2Fv2%2Fpayment-methods%20(Card%20Data%20%2B%20customer_id)%0A%20%20%20%20%0A%20%20%20%20H-%3E%3EV%3A%20Store%20Raw%20Card%20Data%0A%20%20%20%20V--%3E%3EH%3A%20Generate%20Secure%20pm_id%0A%20%20%20%20%0A%20%20%20%20opt%20If%20psp_tokenization%20or%20network_tokenization%20enabled%0A%20%20%20%20%20%20%20%20H-%3E%3EP%3A%20Request%20PSP%2FNetwork%20Token%0A%20%20%20%20%20%20%20%20P--%3E%3EH%3A%20Return%20External%20Token%0A%20%20%20%20%20%20%20%20H-%3E%3EV%3A%20Map%20External%20Token%20to%20pm_id%0A%20%20%20%20end%0A%0A%20%20%20%20H--%3E%3EM%3A%20Return%20pm_id%20%26%20Token%20Details%0A%20%20%20%20end%0A%0A%20%20%20%20M--%3E%3EC</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="763" height="397"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 36.15338186690625 33.876698536 L 36.15338186690625 397.774765896" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="7.732640615384615,3.3508109333333334"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 154.22325129158074 33.876698536 L 154.22325129158074 397.774765896" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="7.732640615384615,3.3508109333333334"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 419.29952940766145 33.876698536 L 419.29952940766145 397.774765896" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="7.732640615384615,3.3508109333333334"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 574.721205472961 33.876698536 L 574.721205472961 397.774765896" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="7.732640615384615,3.3508109333333334"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 695.6868818654649 33.876698536 L 695.6868818654649 397.774765896" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="7.732640615384615,3.3508109333333334"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 5.026216400000003 6.835654304000002 L 67.2805473338125 6.835654304000002 L 67.2805473338125 33.876698536 L 5.026216400000003 33.876698536 L 5.026216400000003 6.835654304000002 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="15.933105988000001" y="23.824265736" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Customer</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 108.83462647408855 6.835654304000002 L 199.6118761090729 6.835654304000002 L 199.6118761090729 33.876698536 L 108.83462647408855 33.876698536 L 108.83462647408855 6.835654304000002 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="119.74151606208855" y="23.824265736" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Merchant Server</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 367.952103320638 6.835654304000002 L 470.6469554946849 6.835654304000002 L 470.6469554946849 33.876698536 L 367.952103320638 33.876698536 L 367.952103320638 6.835654304000002 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="378.858992908638" y="23.824265736" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Hyperswitch Server</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 526.8246842321289 6.835654304000002 L 622.617726713793 6.835654304000002 L 622.617726713793 33.876698536 L 526.8246842321289 33.876698536 L 526.8246842321289 6.835654304000002 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="537.7315738201289" y="23.824265736" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Hyperswitch Vault</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 632.670159513793 6.835654304000002 L 758.7036042171368 6.835654304000002 L 758.7036042171368 33.876698536 L 632.670159513793 33.876698536 L 632.670159513793 6.835654304000002 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="643.577049101793" y="23.824265736" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">PSP / Network (Optional)</text></g></g><g><g><rect fill="white" stroke="none" x="55.82981231598177" y="53.981564136" width="86.49806016226563" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="57.33767723598177" y="63.028753656" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Enters Card Details </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="49.556625600239585" y="63.028753656" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 36.15338186690625 67.049726776 L 152.96669719158075 67.049726776" stroke-miterlimit="10" stroke-width="0.8377027333333333"/><g transform="translate(154.22325129158074,67.049726776) translate(-154.22325129158074,-67.049726776)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 145.61079320970134 63.20763601561635 L 153.28152829739645 67.049726776 L 145.61079320970134 70.89181753638366" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><rect fill="white" stroke="none" x="246.11133640374223" y="82.128375976" width="89.0811595275" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="247.61920132374223" y="91.175565496" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST /v2/customers</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="239.83814968800004" y="91.175565496" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 154.22325129158074 95.196538616 L 418.04297530766144 95.196538616" stroke-miterlimit="10" stroke-width="0.8377027333333333"/><g transform="translate(419.29952940766145,95.196538616) translate(-419.29952940766145,-95.196538616)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 410.68707132578203 91.35444785561634 L 418.35780641347714 95.196538616 L 410.68707132578203 99.03862937638365" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><rect fill="white" stroke="none" x="248.4370123680977" y="110.275187816" width="84.42980759878907" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.9448772880977" y="119.322377336" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return customer_id</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="242.1638256523555" y="119.322377336" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 419.29952940766145 123.343350456 L 155.47980539158073 123.343350456" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="4.02097312"/><g transform="translate(154.22325129158074,123.343350456) translate(-154.22325129158074,-123.343350456)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 162.83570937346013 119.50125969561634 L 155.16497428576503 123.343350456 L 162.83570937346013 127.18544121638365" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><rect fill="white" stroke="none" x="173.8996817406563" y="138.421999656" width="233.50446885367188" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="175.4075466606563" y="147.469189176" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST /v2/payment-methods (Card Data + customer_id)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="167.6264950249141" y="147.469189176" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 154.22325129158074 151.490162296 L 418.04297530766144 151.490162296" stroke-miterlimit="10" stroke-width="0.8377027333333333"/><g transform="translate(419.29952940766145,151.490162296) translate(-419.29952940766145,-151.490162296)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 410.68707132578203 147.64807153561634 L 418.35780641347714 151.490162296 L 410.68707132578203 155.33225305638365" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><rect fill="white" stroke="none" x="455.0574036433581" y="166.568811496" width="91.68697922964844" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="456.5652685633581" y="175.61600101599998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Store Raw Card Data</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="448.7842169276159" y="175.61600101599998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 419.29952940766145 179.636974136 L 573.4646513729609 179.636974136" stroke-miterlimit="10" stroke-width="0.8377027333333333"/><g transform="translate(574.721205472961,179.636974136) translate(-574.721205472961,-179.636974136)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 566.1087473910816 175.79488337561634 L 573.7794824787767 179.636974136 L 566.1087473910816 183.47906489638365" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><rect fill="white" stroke="none" x="449.8639679744128" y="194.715623336" width="102.07385056753907" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="451.37183289441276" y="203.76281285599998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate Secure pm_id</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="443.5907812586706" y="203.76281285599998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 574.721205472961 207.783785976 L 420.55608350766147 207.783785976" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="4.02097312"/><g transform="translate(419.29952940766145,207.783785976) translate(-419.29952940766145,-207.783785976)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 427.9119874895409 203.94169521561633 L 420.24125240184577 207.783785976 L 427.9119874895409 211.62587673638365" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><rect fill="white" stroke="none" x="499.72073042603586" y="250.004003736" width="123.32600205679688" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="501.22859534603583" y="259.051193256" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Request PSP/Network Token</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="493.44754371029364" y="259.051193256" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 419.29952940766145 263.072166376 L 694.4303277654649 263.072166376" stroke-miterlimit="10" stroke-width="0.8377027333333333"/><g transform="translate(695.6868818654649,263.072166376) translate(-695.6868818654649,-263.072166376)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 687.0744237835855 259.23007561561633 L 694.7451588712806 263.072166376 L 687.0744237835855 266.91425713638364" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><rect fill="white" stroke="none" x="513.720272662364" y="278.15081557599996" width="95.32691758414063" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="515.228137582364" y="287.198005096" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return External Token</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="507.44708594662177" y="287.198005096" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 695.6868818654649 291.218978216 L 420.55608350766147 291.218978216" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="4.02097312"/><g transform="translate(419.29952940766145,291.218978216) translate(-419.29952940766145,-291.218978216)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 427.9119874895409 287.3768874556163 L 420.24125240184577 291.218978216 L 427.9119874895409 295.06106897638364" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><rect fill="white" stroke="none" x="438.975959856737" y="306.29762741599995" width="123.84986680289063" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="440.483824776737" y="315.344816936" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Map External Token to pm_id</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="432.7027731409948" y="315.344816936" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 419.29952940766145 319.365790056 L 573.4646513729609 319.365790056" stroke-miterlimit="10" stroke-width="0.8377027333333333"/><g transform="translate(574.721205472961,319.365790056) translate(-574.721205472961,-319.365790056)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 566.1087473910816 315.5236992956163 L 573.7794824787767 319.365790056 L 566.1087473910816 323.20788081638364" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><rect fill="white" stroke="none" x="230.02761905755082" y="349.523088456" width="126.4374827696875" height="13.06816264"/><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="231.53548397755083" y="358.570277976" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return pm_id &amp; Token Details</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="bold" text-decoration="normal" x="218.56554379200395" y="358.570277976" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">10 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 419.29952940766145 362.591251096 L 155.47980539158073 362.591251096" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="4.02097312"/><g transform="translate(154.22325129158074,362.591251096) translate(-154.22325129158074,-362.591251096)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 162.83570937346013 358.74916033561635 L 155.16497428576503 362.591251096 L 162.83570937346013 366.43334185638366" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 384.11601460766144 222.862435176 L 730.8703966654649 222.862435176 L 730.8703966654649 334.444439256 L 384.11601460766144 334.444439256 L 384.11601460766144 222.862435176 Z" stroke-miterlimit="10" stroke-width="1.4360618285714286" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 384.11601460766144 222.862435176 L 384.11601460766144 234.925354536 L 415.8188263746536 234.925354536 L 421.8502860546536 228.893894856 L 421.8502860546536 222.862435176 L 384.11601460766144 222.862435176" stroke-miterlimit="10" stroke-width="1.4360618285714286"/><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="394.16844740766146" y="230.90438141599998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">opt</text><g><rect fill="white" stroke="none" x="430.39485393465367" y="223.66662979999998" width="193.67884629507813" height="10.454530112"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="431.90271885465364" y="230.90438141599998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[If psp_tokenization or network_tokenization enabled]</text></g></g></g></svg>