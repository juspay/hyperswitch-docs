<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1194.4925032071276" height="2052.2704107907266"><desc>title%20Split%20payments%0A%0Aparticipant%20Merchant%20Server%0Aparticipant%20HS%20SDK%0Aparticipant%20HS%20Server%0Aparticipant%20Gift%20card%20Provider%0Aparticipant%20PSP%0A%0Anote%20over%20Merchant%20Server%2C%20PSP%3A%20%3D%3D%3D%20Initialization%20%3D%3D%3D%0A%0AMerchant%20Server-%3EHS%20Server%3A%20%2Fpayments%2Fcreate-intent%20with%20split_txns_enabled%20flag%0AMerchant%20Server-%3EHS%20SDK%3A%20Loads%20SDK%0A%0AHS%20SDK-%3EHS%20Server%3A%20%2FPML%0AHS%20Server-%3EHS%20SDK%3A%20Payment%20Methods%20List%20(with%20gift%20card%20PM%20details)%0A%0A%0Anote%20over%20HS%20SDK%3A%20Customer%20chooses%20Gift%20Card%20option%5Cnand%20enters%20card%20details%0A%0Anote%20over%20Merchant%20Server%2C%20PSP%3A%20%3D%3D%3D%20Eligibility%20Check%20%3D%3D%3D%0A%0AHS%20SDK-%3EHS%20Server%3A%20%2Feligibility%2Fcheck-balance-and-apply-pm-data%0AHS%20Server-%3EGift%20card%20Provider%3A%20GiftCardBalanceCheck%0AGift%20card%20Provider-%3EHS%20Server%3A%20Response%0A%0Anote%20over%20HS%20Server%3A%20Cache%20Gift%20Card%20Balance%0AHS%20Server-%3EHS%20SDK%3A%20%2Feligibility%20response%20with%20balance%20and%20additional_pm_required%0A%0Anote%20over%20HS%20SDK%3A%20If%20!additional_pm_required%20(balance%20%3E%3D%20amount)%3A%5Cn%E2%86%92%20Show%20'Pay%20Now'%20with%20only%20Gift%20Card%5Cnelse%3A%5Cn%E2%86%92%20Prompt%20user%20to%20select%20another%20allowed%20method%5Cn%E2%86%92%20Remaining%20balance%20to%20be%20paid%20with%20other%20PM%0A%0Anote%20over%20Merchant%20Server%2C%20PSP%3A%20%3D%3D%3D%20Payment%20Confirmation%20%3D%3D%3D%0A%0AHS%20SDK-%3EHS%20Server%3A%20%2Fconfirm%20with%5Cn-%20primary%20PM%20details%5Cn-%20split%20PM%20details%5CnFetch%20gift%20card%20balance%20from%20cache%5Cnand%20calculate%20%60remaining_amount%60%0A%0Anote%20over%20HS%20Server%3AExecute%20split%20sequentially%3A%5Cn%20%201.%20Charge%20primary%20PM%5Cn%20%202.%20If%20success%20%E2%86%92%20Charge%20Gift%20Card%0A%0Anote%20over%20Merchant%20Server%2C%20PSP%3A%20%3D%3D%3D%20Primary%20PM%20Attempt%20%3D%3D%3D%0A%0AHS%20Server-%3EPSP%3A%20Authorize%20%60remaining_amount%60%20with%20primary%20PM%0APSP-%3EHS%20Server%3A%20Response%20with%20status%0A%0Anote%20over%20HS%20Server%3AIf%20primary%20PM%20%3D%20charged%3A%5Cn%E2%86%92%20Initiate%20Gift%20Card%20payment%5CnIf%20primary%20PM%20%3D%20processing%3A%5Cn%E2%86%92%20Wait%5Cn%E2%86%92%20Void%20if%20stuck%20beyond%20fulfillment%20time%5CnIf%20primary%20PM%20%3D%20failure%3A%5Cn%E2%86%92%20Retry%20silently%20(if%20allowed)%5Cn%E2%86%92%20Else%20fail%20intent%2C%20manual%20retry%20possible%0A%0Anote%20over%20Merchant%20Server%2C%20PSP%3A%20%3D%3D%3D%20Split%20PM%20Attempt%20(Gift%20Card)%20%3D%3D%3D%0A%0AHS%20Server-%3EGift%20card%20Provider%3A%20Authorize%20with%20Gift%20Card%20Balance%0AGift%20card%20Provider-%3EHS%20Server%3A%20Response%0A%0Anote%20over%20HS%20Server%3AIf%20Gift%20Card%20%3D%20success%3A%5Cn%E2%86%92%20Mark%20payment%20intent%20as%20Processing%2FSuccess%5CnIf%20Gift%20Card%20%3D%20failure%3A%5Cn%E2%86%92%20Retry%20silently%20(if%20allowed)%5Cn%E2%86%92%20Else%20fail%20payment%20and%20auto-refund%20primary%20PM%0A%0Anote%20over%20Merchant%20Server%2C%20PSP%3A%20%3D%3D%3D%20Final%20Response%20%3D%3D%3D%0A%0AHS%20Server-%3EHS%20SDK%3A%20Final%20response%20with%20payment%20intent%20status%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1194" height="2052"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 82.06329436571876 103.10369087072726 L 82.06329436571876 2052.2704107907266" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 274.38521643353124 103.10369087072726 L 274.38521643353124 2052.2704107907266" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 716.5504910089869 103.10369087072726 L 716.5504910089869 2052.2704107907266" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 975.3157411703801 103.10369087072726 L 975.3157411703801 2052.2704107907266" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1151.9424305821315 103.10369087072726 L 1151.9424305821315 2052.2704107907266" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.795878700000003 55.60594589072727 L 155.33071003143752 55.60594589072727 L 155.33071003143752 103.10369087072726 L 8.795878700000003 103.10369087072726 L 8.795878700000003 55.60594589072727 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="27.88293547900001" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Merchant Server</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 228.00754075804687 55.60594589072727 L 320.76289210901564 55.60594589072727 L 320.76289210901564 103.10369087072726 L 228.00754075804687 103.10369087072726 L 228.00754075804687 55.60594589072727 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="247.09459753704687" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">HS SDK</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 663.6552906142642 55.60594589072727 L 769.4456914037096 55.60594589072727 L 769.4456914037096 103.10369087072726 L 663.6552906142642 103.10369087072726 L 663.6552906142642 55.60594589072727 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="682.7423473932643" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">HS Server</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 899.1993646281965 55.60594589072727 L 1051.4321177125637 55.60594589072727 L 1051.4321177125637 103.10369087072726 L 899.1993646281965 103.10369087072726 L 899.1993646281965 55.60594589072727 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="918.2864214071965" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Gift card Provider</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1118.1882366571353 55.60594589072727 L 1185.6966245071276 55.60594589072727 L 1185.6966245071276 103.10369087072726 L 1118.1882366571353 103.10369087072726 L 1118.1882366571353 55.60594589072727 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1137.2752934361354" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">PSP</text></g></g><g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16pt" font-style="normal" font-weight="normal" text-decoration="normal" x="527.0526733398438" y="26.547561167272725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Split payments</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 66.23071270571876 138.28720567072725 L 1151.9424305821315 138.28720567072725 L 1167.7750122421314 154.11978733072723 L 1167.7750122421314 178.74824769072725 L 66.23071270571876 178.74824769072725 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1151.9424305821315 138.28720567072725 L 1151.9424305821315 154.11978733072723 L 1167.7750122421314 154.11978733072723" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="548.946336289843" y="162.9156660307273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">=== Initialization ===</text></g><g><rect fill="white" stroke="none" x="228.38974772969658" y="205.13588379072726" width="341.8342899153125" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="231.0285113396966" y="220.96846545072728" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">/payments/create-intent with split_txns_enabled flag</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 82.06329436571876 228.00516841072726 L 702.0666107496536 228.00516841072726" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g transform="translate(716.5504910089869,228.00516841072726) translate(-716.5504910089869,-228.00516841072726)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 701.8906931756536 220.6752694940606 L 716.5504910089869 228.00516841072726 L 701.8906931756536 235.33506732739394 Z"/></g></g><g><rect fill="white" stroke="none" x="138.5060469043711" y="254.39280451072722" width="79.43641699050781" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="141.1448105143711" y="270.22538617072723" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Loads SDK</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 82.06329436571876 277.26208913072725 L 259.9013361741979 277.26208913072725" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g transform="translate(274.38521643353124,277.26208913072725) translate(-274.38521643353124,-277.26208913072725)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 259.7254186001979 269.9321902140606 L 274.38521643353124 277.26208913072725 L 259.7254186001979 284.5919880473939 Z"/></g></g><g><rect fill="white" stroke="none" x="475.72100447893484" y="303.64972523072726" width="39.493698484648434" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="478.35976808893486" y="319.4823068907273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">/PML</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 274.38521643353124 326.51900985072723 L 702.0666107496536 326.51900985072723" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g transform="translate(716.5504910089869,326.51900985072723) translate(-716.5504910089869,-326.51900985072723)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 701.8906931756536 319.1891109340606 L 716.5504910089869 326.51900985072723 L 701.8906931756536 333.8489087673939 Z"/></g></g><g><rect fill="white" stroke="none" x="335.9894981312786" y="352.90664595072724" width="318.9566654035938" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="338.6282617412786" y="368.73922761072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Payment Methods List (with gift card PM details)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 716.5504910089869 375.7759305707272 L 288.86909669286456 375.7759305707272" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g transform="translate(274.38521643353124,375.7759305707272) translate(-274.38521643353124,-375.7759305707272)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 289.0450142668646 368.44603165406056 L 274.38521643353124 375.7759305707272 L 289.0450142668646 383.10582948739386 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 135.2757608953086 402.1635666707272 L 397.66209031175384 402.1635666707272 L 413.49467197175386 417.99614833072724 L 413.49467197175386 460.2163660907272 L 135.2757608953086 460.2163660907272 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 397.66209031175384 402.1635666707272 L 397.66209031175384 417.99614833072724 L 413.49467197175386 417.99614833072724" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="159.90422125530858" y="426.7920270307272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Customer chooses Gift Card option</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="159.90422125530858" y="444.3837844307272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">and enters card details</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 66.23071270571876 486.60400219072716 L 1151.9424305821315 486.60400219072716 L 1167.7750122421314 502.4365838507272 L 1167.7750122421314 527.0650442107271 L 66.23071270571876 527.0650442107271 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1151.9424305821315 486.60400219072716 L 1151.9424305821315 502.4365838507272 L 1167.7750122421314 502.4365838507272" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="535.9184279646477" y="511.2324625507271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">=== Eligibility Check ===</text></g><g><rect fill="white" stroke="none" x="349.82274245500906" y="553.4526803107271" width="291.2902225325" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="352.4615060650091" y="569.2852619707271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">/eligibility/check-balance-and-apply-pm-data</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 274.38521643353124 576.3219649307272 L 702.0666107496536 576.3219649307272" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g transform="translate(716.5504910089869,576.3219649307272) translate(-716.5504910089869,-576.3219649307272)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 701.8906931756536 568.9920660140605 L 716.5504910089869 576.3219649307272 L 701.8906931756536 583.6518638473939 Z"/></g></g><g><rect fill="white" stroke="none" x="768.7381848771445" y="602.7096010307272" width="154.38986242507812" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="771.3769484871444" y="618.5421826907271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GiftCardBalanceCheck</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 716.5504910089869 625.5788856507272 L 960.8318609110468 625.5788856507272" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g transform="translate(975.3157411703801,625.5788856507272) translate(-975.3157411703801,-625.5788856507272)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 960.6559433370468 618.2489867340605 L 975.3157411703801 625.5788856507272 L 960.6559433370468 632.9087845673939 Z"/></g></g><g><rect fill="white" stroke="none" x="810.2879209000937" y="651.9665217507272" width="71.29039037917968" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="812.9266845100937" y="667.7991034107272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Response</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 975.3157411703801 674.8358063707273 L 731.0343712683202 674.8358063707273" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g transform="translate(716.5504910089869,674.8358063707273) translate(-716.5504910089869,-674.8358063707273)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 731.2102888423202 667.5059074540605 L 716.5504910089869 674.8358063707273 L 731.2102888423202 682.165705287394 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 610.8447448823854 701.2234424707273 L 806.4236554755886 701.2234424707273 L 822.2562371355885 717.0560241307272 L 822.2562371355885 741.6844844907273 L 610.8447448823854 741.6844844907273 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 806.4236554755886 701.2234424707273 L 806.4236554755886 717.0560241307272 L 822.2562371355885 717.0560241307272" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="635.4732052423853" y="725.8519028307273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Cache Gift Card Balance</text></g><g><rect fill="white" stroke="none" x="295.20212935686453" y="768.0721205907273" width="400.53143347" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="297.84089296686454" y="783.9047022507273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">/eligibility response with balance and additional_pm_required</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 716.5504910089869 790.9414052107273 L 288.86909669286456 790.9414052107273" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g transform="translate(274.38521643353124,790.9414052107273) translate(-274.38521643353124,-790.9414052107273)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 289.0450142668646 783.6115062940606 L 274.38521643353124 790.9414052107273 L 289.0450142668646 798.271304127394 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 90.85917306571875 817.3290413107275 L 442.0786781413437 817.3290413107275 L 457.9112598013437 833.1616229707274 L 457.9112598013437 928.1571129307274 L 90.85917306571875 928.1571129307274 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 442.0786781413437 817.3290413107275 L 442.0786781413437 833.1616229707274 L 457.9112598013437 833.1616229707274" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="115.48763342571874" y="841.9575016707274" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If !additional_pm_required (balance &gt;= amount):</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="115.48763342571874" y="859.5492590707274" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">→ Show 'Pay Now' with only Gift Card</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="115.48763342571874" y="877.1410164707274" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">else:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="115.48763342571874" y="894.7327738707274" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">→ Prompt user to select another allowed method</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="115.48763342571874" y="912.3245312707274" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">→ Remaining balance to be paid with other PM</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 66.23071270571876 954.5447490307273 L 1151.9424305821315 954.5447490307273 L 1167.7750122421314 970.3773306907273 L 1167.7750122421314 995.0057910507273 L 66.23071270571876 995.0057910507273 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1151.9424305821315 954.5447490307273 L 1151.9424305821315 970.3773306907273 L 1167.7750122421314 970.3773306907273" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="514.7301573958" y="979.1732093907274" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">=== Payment Confirmation ===</text></g><g><rect fill="white" stroke="none" x="380.3810310292278" y="1021.3934271507273" width="87.55380285476562" height="22.86928462"/><rect fill="white" stroke="none" x="380.3810310292278" y="1038.9851845507274" width="135.61389196609375" height="22.86928462"/><rect fill="white" stroke="none" x="380.3810310292278" y="1056.5769419507274" width="112.81504858230468" height="22.86928462"/><rect fill="white" stroke="none" x="380.3810310292278" y="1074.1686993507274" width="230.1736453840625" height="22.86928462"/><rect fill="white" stroke="none" x="380.3810310292278" y="1091.7604567507274" width="226.9309696028125" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.0197946392278" y="1037.2260088107273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">/confirm with</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.0197946392278" y="1054.8177662107273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">- primary PM details</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.0197946392278" y="1072.4095236107273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">- split PM details</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.0197946392278" y="1090.0012810107273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Fetch gift card balance from cache</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.0197946392278" y="1107.5930384107273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">and calculate `remaining_amount`</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 274.38521643353124 1114.6297413707273 L 702.0666107496536 1114.6297413707273" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g transform="translate(716.5504910089869,1114.6297413707273) translate(-716.5504910089869,-1114.6297413707273)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 701.8906931756536 1107.2998424540606 L 716.5504910089869 1114.6297413707273 L 701.8906931756536 1121.959640287394 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 580.3043090913698 1141.0173774707273 L 836.9640912666041 1141.0173774707273 L 852.7966729266041 1156.8499591307273 L 852.7966729266041 1216.6619342907272 L 580.3043090913698 1216.6619342907272 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 836.9640912666041 1141.0173774707273 L 836.9640912666041 1156.8499591307273 L 852.7966729266041 1156.8499591307273" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="604.9327694513697" y="1165.645837830727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Execute split sequentially:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="604.9327694513697" y="1183.237595230727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  1. Charge primary PM</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="604.9327694513697" y="1200.829352630727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  2. If success → Charge Gift Card</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 66.23071270571876 1243.0495703907272 L 1151.9424305821315 1243.0495703907272 L 1167.7750122421314 1258.8821520507272 L 1167.7750122421314 1283.5106124107272 L 66.23071270571876 1283.5106124107272 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1151.9424305821315 1243.0495703907272 L 1151.9424305821315 1258.8821520507272 L 1167.7750122421314 1258.8821520507272" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="521.6736083235344" y="1267.678030750727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">=== Primary PM Attempt ===</text></g><g><rect fill="white" stroke="none" x="778.4366843071413" y="1309.8982485107272" width="311.619568235625" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="781.0754479171412" y="1325.7308301707271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorize `remaining_amount` with primary PM</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 716.5504910089869 1332.767533130727 L 1137.4585503227981 1332.767533130727" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g transform="translate(1151.9424305821315,1332.767533130727) translate(-1151.9424305821315,-1332.767533130727)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1137.282632748798 1325.4376342140604 L 1151.9424305821315 1332.767533130727 L 1137.282632748798 1340.0974320473938 Z"/></g></g><g><rect fill="white" stroke="none" x="861.936997112317" y="1359.155169230727" width="144.61892736648437" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="864.575760722317" y="1374.987750890727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Response with status</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1151.9424305821315 1382.024453850727 L 731.0343712683202 1382.024453850727" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g transform="translate(716.5504910089869,1382.024453850727) translate(-716.5504910089869,-1382.024453850727)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 731.2102888423202 1374.6945549340603 L 716.5504910089869 1382.024453850727 L 731.2102888423202 1389.3543527673937 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 563.1819336030885 1408.412089950727 L 854.0864667548854 1408.412089950727 L 869.9190484148853 1424.244671610727 L 869.9190484148853 1572.015433770727 L 563.1819336030885 1572.015433770727 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 854.0864667548854 1408.412089950727 L 854.0864667548854 1424.244671610727 L 869.9190484148853 1424.244671610727" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="587.8103939630885" y="1433.0405503107268" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If primary PM = charged:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="587.8103939630885" y="1450.6323077107268" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">→ Initiate Gift Card payment</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="587.8103939630885" y="1468.2240651107268" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If primary PM = processing:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="587.8103939630885" y="1485.8158225107268" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">→ Wait</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="587.8103939630885" y="1503.4075799107268" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">→ Void if stuck beyond fulfillment time</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="587.8103939630885" y="1520.9993373107268" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If primary PM = failure:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="587.8103939630885" y="1538.5910947107268" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">→ Retry silently (if allowed)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="587.8103939630885" y="1556.1828521107268" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">→ Else fail intent, manual retry possible</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 66.23071270571876 1598.403069870727 L 1151.9424305821315 1598.403069870727 L 1167.7750122421314 1614.235651530727 L 1167.7750122421314 1638.864111890727 L 66.23071270571876 1638.864111890727 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1151.9424305821315 1598.403069870727 L 1151.9424305821315 1614.235651530727 L 1167.7750122421314 1614.235651530727" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="496.4159178938469" y="1623.0315302307267" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">=== Split PM Attempt (Gift Card) ===</text></g><g><rect fill="white" stroke="none" x="737.3674039323203" y="1665.251747990727" width="217.13142431472656" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="740.0061675423202" y="1681.0843296507269" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorize with Gift Card Balance</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 716.5504910089869 1688.1210326107268 L 960.8318609110468 1688.1210326107268" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g transform="translate(975.3157411703801,1688.1210326107268) translate(-975.3157411703801,-1688.1210326107268)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 960.6559433370468 1680.7911336940601 L 975.3157411703801 1688.1210326107268 L 960.6559433370468 1695.4509315273935 Z"/></g></g><g><rect fill="white" stroke="none" x="810.2879209000937" y="1714.5086687107269" width="71.29039037917968" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="812.9266845100937" y="1730.3412503707268" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Response</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 975.3157411703801 1737.3779533307268 L 731.0343712683202 1737.3779533307268" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g transform="translate(716.5504910089869,1737.3779533307268) translate(-716.5504910089869,-1737.3779533307268)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 731.2102888423202 1730.04805441406 L 716.5504910089869 1737.3779533307268 L 731.2102888423202 1744.7078522473935 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 533.4432098482057 1763.7655894307268 L 883.8251905097682 1763.7655894307268 L 899.6577721697681 1779.5981710907267 L 899.6577721697681 1874.5936610507267 L 533.4432098482057 1874.5936610507267 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 883.8251905097682 1763.7655894307268 L 883.8251905097682 1779.5981710907267 L 899.6577721697681 1779.5981710907267" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="558.0716702082057" y="1788.3940497907265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If Gift Card = success:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="558.0716702082057" y="1805.9858071907265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">→ Mark payment intent as Processing/Success</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="558.0716702082057" y="1823.5775645907265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If Gift Card = failure:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="558.0716702082057" y="1841.1693219907265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">→ Retry silently (if allowed)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="558.0716702082057" y="1858.7610793907265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">→ Else fail payment and auto-refund primary PM</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 66.23071270571876 1900.9812971507267 L 1151.9424305821315 1900.9812971507267 L 1167.7750122421314 1916.8138788107267 L 1167.7750122421314 1941.4423391707267 L 66.23071270571876 1941.4423391707267 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1151.9424305821315 1900.9812971507267 L 1151.9424305821315 1916.8138788107267 L 1167.7750122421314 1916.8138788107267" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="536.3156905378899" y="1925.6097575107265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">=== Final Response ===</text></g><g><rect fill="white" stroke="none" x="357.96872328997" y="1967.8299752707267" width="274.99826086257815" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="360.60748689997" y="1983.6625569307266" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Final response with payment intent status</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 716.5504910089869 1990.6992598907266 L 288.86909669286456 1990.6992598907266" stroke-miterlimit="10" stroke-width="1.4659797833333332"/><g transform="translate(274.38521643353124,1990.6992598907266) translate(-274.38521643353124,-1990.6992598907266)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 289.0450142668646 1983.3693609740599 L 274.38521643353124 1990.6992598907266 L 289.0450142668646 1998.0291588073933 Z"/></g></g></g><g/><g/><g/><g/><g/></g></svg>